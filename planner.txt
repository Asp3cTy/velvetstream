üöÄ 1. Defini√ß√£o dos Fluxos do Usu√°rio
Antes de definir as rotas, precisamos entender os fluxos principais que um usu√°rio ter√° dentro da plataforma.

üé¨ 1.1. Fluxos principais
Autentica√ß√£o e Conta

Cadastro de usu√°rio
Login e logout
Recupera√ß√£o de senha
Gerenciamento de perfil (nome, foto, senha, idioma, etc.)
Configura√ß√£o de dispositivos autorizados (gest√£o de sess√µes ativas)
Assinatura e Pagamento

Exibi√ß√£o dos planos de assinatura
Pagamento via Mercado Pago (cart√£o de cr√©dito, PIX, boleto)
Cancelamento ou atualiza√ß√£o da assinatura
Faturamento e hist√≥rico de pagamentos
Explora√ß√£o de Conte√∫do

P√°gina inicial com recomenda√ß√µes
Pesquisa e filtros de filmes/s√©ries
Detalhes de um filme/s√©rie (sinopse, trailer, avalia√ß√µes)
Listagem de temporadas e epis√≥dios
Player e Streaming

Reprodu√ß√£o segura de v√≠deos (HLS, DRM opcional)
Continua√ß√£o de v√≠deos de onde parou
Legendas e configura√ß√µes de qualidade
Listas e Personaliza√ß√£o

Adicionar conte√∫do √† "Minha Lista"
Hist√≥rico de assistidos
Avalia√ß√µes e curtidas
Administra√ß√£o (para o dono do VelvetStream)

Upload e gerenciamento de v√≠deos
Relat√≥rios de acessos e pagamentos
Controle de usu√°rios e assinaturas
Configura√ß√£o de planos de assinatura
‚öôÔ∏è 2. Defini√ß√£o das Rotas do Backend
Agora, com base nos fluxos, vamos definir as rotas da API.

üìå 2.1. Rotas de Autentica√ß√£o (/auth)
M√©todo	Rota	Descri√ß√£o
POST	/auth/register	Cadastro de usu√°rio
POST	/auth/login	Login (retorna JWT)
POST	/auth/logout	Logout (invalida token)
POST	/auth/forgot-password	Envia e-mail para redefini√ß√£o de senha
POST	/auth/reset-password	Reseta a senha ap√≥s valida√ß√£o
GET	/auth/me	Retorna dados do usu√°rio autenticado
Autentica√ß√£o: JWT + Refresh Token
Seguran√ßa: Rate Limiting, Helmet, CSRF Protection
üé• 2.2. Rotas de Conte√∫do (/content)
M√©todo	Rota	Descri√ß√£o
GET	/content/home	Retorna destaques e recomenda√ß√µes
GET	/content/search?query=	Pesquisa por filmes/s√©ries
GET	/content/:id	Retorna detalhes de um filme/s√©rie
GET	/content/:id/seasons	Retorna temporadas de uma s√©rie
GET	/content/:id/episodes	Retorna epis√≥dios de uma temporada
Seguran√ßa: Controle de acesso via assinatura (middleware)
‚ñ∂Ô∏è 2.3. Rotas do Player (/player)
M√©todo	Rota	Descri√ß√£o
GET	/player/:id	Retorna URL segura do v√≠deo para o player
POST	/player/progress	Salva progresso do usu√°rio no v√≠deo
GET	/player/progress/:id	Retorna progresso salvo do usu√°rio
Seguran√ßa: URLs expiram ap√≥s X minutos para evitar compartilhamento
CDN: BunnyCDN para entrega de v√≠deos
üõí 2.4. Rotas de Assinatura & Pagamento (/subscription)
M√©todo	Rota	Descri√ß√£o
GET	/subscription/plans	Retorna os planos dispon√≠veis
POST	/subscription/create	Inicia uma assinatura via Mercado Pago
GET	/subscription/status	Verifica status da assinatura do usu√°rio
POST	/subscription/cancel	Cancela a assinatura
Integra√ß√£o: API Mercado Pago (Webhooks para atualiza√ß√£o autom√°tica)
Seguran√ßa: Verifica√ß√£o via JWT + Criptografia de dados sens√≠veis
üîí 2.5. Rotas de Seguran√ßa e Controle de Sess√µes (/security)
M√©todo	Rota	Descri√ß√£o
GET	/security/devices	Lista os dispositivos autorizados
POST	/security/revoke-device	Revoga um dispositivo ativo
Turnstile Cloudflare para valida√ß√£o de formul√°rios
Rate Limiting para evitar brute-force
Helmet.js para refor√ßar seguran√ßa de cabe√ßalhos HTTP
üõ† 2.6. Rotas de Administra√ß√£o (/admin)
M√©todo	Rota	Descri√ß√£o
POST	/admin/upload	Faz upload de um v√≠deo
DELETE	/admin/delete/:id	Remove um v√≠deo
GET	/admin/reports	Gera relat√≥rios de acessos/pagamentos
Seguran√ßa: Apenas admins autenticados via role-based access control (RBAC)